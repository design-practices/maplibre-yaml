type: map
id: cluster-demo
config:
  center: [-120, 37]
  zoom: 3
  mapStyle: "https://demotiles.maplibre.org/style.json"
layers:
  - id: earthquakes
    type: circle
    source:
      type: geojson
      url: "https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_month.geojson"
      cluster: true
      clusterRadius: 50
      clusterMaxZoom: 14
    filter: ["has", "point_count"]
    paint:
      circle-radius:
        - step
        - ["get", "point_count"]
        - 20
        - 100
        - 30
        - 750
        - 40
      circle-color: "#3b82f6"
      circle-opacity: 0.8
  - id: cluster-count
    type: symbol
    source: earthquakes
    filter: ["has", "point_count"]
    layout:
      text-field: "{point_count_abbreviated}"
      text-size: 12
  - id: unclustered
    type: circle
    source: earthquakes
    filter: ["!", ["has", "point_count"]]
    paint:
      circle-radius: 6
      circle-color: "#ef4444"